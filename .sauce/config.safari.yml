apiVersion: v1alpha
kind: testcafe
sauce:
  region: us-west-1
  sauceignore: .sauceignore
  concurrency: 5
defaults:
  timeout: 30m
metadata:
  name: Alloy Reactor Extension - Safari
rootDir: ./
env:
  NPM_PACKAGE_VERSION: $NPM_PACKAGE_VERSION
  SAUCE_USERNAME: $SAUCE_USERNAME
  SAUCE_ACCESS_KEY: $SAUCE_ACCESS_KEY
  SAUCE_CLIENT_TIMEOUT: 300s
  EDGE_E2E_PRIVATE_KEY_CONTENTS: $EDGE_E2E_PRIVATE_KEY_CONTENTS
  EDGE_E2E_CLIENT_SECRET: $EDGE_E2E_CLIENT_SECRET
  REACTOR_IO_INTEGRATION_PRIVATE_KEY_CONTENTS: $REACTOR_IO_INTEGRATION_PRIVATE_KEY_CONTENTS
  REACTOR_IO_INTEGRATION_CLIENT_SECRET: $REACTOR_IO_INTEGRATION_CLIENT_SECRET
testcafe:
  version: 3.6.2
nodeVersion: "20"
speed: 1
selectorTimeout: 2000
disablePageCaching: false
timeZone: New_York
pageRequestTimeout: 5000
retryTestPages: true
quarantineMode: false
npm:
  dependencies:
    - "@adobe/reactor-sandbox@^12.5.0"
    - "@adobe/auth-token@^1.0.0-beta.13"
    - "react@^18.3.1"
    - "react-dom@^18.3.1"
    - "uuid@^10.0.0"
suites:
  - name: "Component Tests"
    esm: true
    browserName: "safari"
    browserVersion: "latest"
    src:
      - "test/functional/specs/component/**/*.spec.mjs"
    platformName: "macOS 13"

  - name: "Runtime Tests"
    esm: true
    browserName: "safari"
    browserVersion: "latest"
    src:
      - "test/functional/specs/runtime/**/*.spec.mjs"
    platformName: "macOS 13"

  - name: "View Action Tests"
    esm: true
    browserName: "safari"
    browserVersion: "latest"
    src:
      - "test/functional/specs/view/actions/**/*.spec.mjs"
    platformName: "macOS 13"

  - name: "View Configuration Tests"
    esm: true
    browserName: "safari"
    browserVersion: "latest"
    src:
      - "test/functional/specs/view/configuration/**/*.spec.mjs"
    platformName: "macOS 13"

  - name: "View Data Elements Tests"
    esm: true
    browserName: "safari"
    browserVersion: "latest"
    src:
      - "test/functional/specs/view/dataElements/**/*.spec.mjs"
    platformName: "macOS 13"