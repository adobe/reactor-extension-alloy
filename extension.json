{
  "name": "adobe-analytics",
  "version": "0.0.1",
  "displayName": "Adobe Analytics",
  "description": "Adobe Analytics extension for Turbine integration.",
  "icon": "https://placeholdit.imgix.net/~text?txtsize=16&txt=64%C3%9764&w=64&h=64",
  "author": {
    "name": "Adobe Systems",
    "email": "DTM-Engineering@adobe.com"
  },
  "viewBasePath": "dist",
  "libBasePath": "src/lib",
  "configuration": {
    "viewPath": "index.html#/configuration",
    "schema": {
      "$schema": "http://json-schema.org/draft-04/schema#",
      "type": "object",
      "properties": {
        "euComplianceEnabled": {
          "type": "boolean"
        },
        "libraryCode": {
          "type": "object",
          "oneOf": [
            {
              "properties": {
                "type": {
                  "type": "string",
                  "enum": [
                    "managed"
                  ]
                },
                "loadPhase": {
                  "$ref": "#/definitions/loadPhase"
                },
                "accounts": {
                  "$ref": "#/definitions/accounts"
                }
              },
              "additionalProperties": false,
              "required": [
                "type",
                "loadPhase",
                "accounts"
              ]
            },
            {
              "properties": {
                "type": {
                  "type": "string",
                  "enum": [
                    "preinstalled"
                  ]
                },
                "trackerVariableName": {
                  "$ref": "#/definitions/trackerVariableName"
                },
                "accounts": {
                  "$ref": "#/definitions/accounts"
                }
              },
              "additionalProperties": false,
              "required": [
                "type",
                "trackerVariableName"
              ]
            },
            {
              "properties": {
                "type": {
                  "type": "string",
                  "enum": [
                    "remote"
                  ]
                },
                "httpUrl": {
                  "type": "string",
                  "minLength": 1
                },
                "httpsUrl": {
                  "type": "string",
                  "minLength": 1
                },
                "accounts": {
                  "$ref": "#/definitions/accounts"
                },
                "loadPhase": {
                  "$ref": "#/definitions/loadPhase"
                },
                "trackerVariableName": {
                  "$ref": "#/definitions/trackerVariableName"
                }
              },
              "additionalProperties": false,
              "required": [
                "type",
                "httpUrl",
                "httpsUrl",
                "loadPhase",
                "trackerVariableName"
              ]
            },
            {
              "properties": {
                "type": {
                  "type": "string",
                  "enum": [
                    "custom"
                  ]
                },
                "script": {
                  "type": "string",
                  "minLength": 1
                },
                "accounts": {
                  "$ref": "#/definitions/accounts"
                },
                "loadPhase": {
                  "$ref": "#/definitions/loadPhase"
                },
                "trackerVariableName": {
                  "$ref": "#/definitions/trackerVariableName"
                }
              },
              "additionalProperties": false,
              "required": [
                "type",
                "script",
                "loadPhase",
                "trackerVariableName"
              ]
            }
          ]
        },
        "trackerProperties": {
          "properties": {
            "charSet": {
              "type": "string",
              "minLength": 1
            },
            "currencyCode": {
              "type": "string",
              "minLength": 1
            },
            "trackingServer": {
              "type": "string",
              "minLength": 1
            },
            "trackingServerSecure": {
              "type": "string",
              "minLength": 1
            },
            "dc": {
              "type": "string",
              "enum": [
                "122",
                "112"
              ]
            },
            "server": {
              "type": "string",
              "minLength": 1
            },
            "dynamicVariablePrefix": {
              "type": "string",
              "minLength": 1
            },
            "pageName": {
              "type": "string",
              "minLength": 1
            },
            "pageURL": {
              "type": "string",
              "minLength": 1
            },
            "channel": {
              "type": "string",
              "minLength": 1
            },
            "trackInlineStats": {
              "type": "boolean"
            },
            "trackDownloadLinks": {
              "type": "boolean"
            },
            "linkDownloadFileTypes": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              }
            },
            "trackExternalLinks": {
              "type": "boolean"
            },
            "linkExternalFilters": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              }
            },
            "linkInternalFilters": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              }
            },
            "linkLeaveQueryString": {
              "type": "boolean"
            },
            "referrer": {
              "type": "string",
              "minLength": 1
            },
            "campaign": {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "enum": [
                    "value",
                    "queryParam"
                  ]
                },
                "value": {
                  "type": "string",
                  "minLength": 1
                }
              },
              "additionalProperties": false,
              "required": [
                "type",
                "value"
              ]
            },
            "visitorID": {
              "type": "string",
              "minLength": 1
            },
            "visitorNamespace": {
              "type": "string",
              "minLength": 1
            },
            "cookieDomainPeriods": {
              "type": "string",
              "minLength": 1
            },
            "fpCookieDomainPeriods": {
              "type": "string",
              "minLength": 1
            },
            "transactionID": {
              "type": "string",
              "minLength": 1
            },
            "cookieLifetime": {
              "type": "string",
              "minLength": 1
            },
            "hierarchies": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "pattern": "^hier[1-5]$"
                  },
                  "sections": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "minLength": 1
                    },
                    "minItems": 1,
                    "maxItems": 4
                  },
                  "delimiter": {
                    "type": "string",
                    "minLength": 1
                  }
                },
                "additionalProperties": false,
                "required": [
                  "name",
                  "sections",
                  "delimiter"
                ]
              }
            },
            "eVars": {
              "type": "array",
              "items": {
                "type": "object",
                "oneOf": [
                  {
                    "properties": {
                      "name": {
                        "$ref": "#/definitions/eVarName"
                      },
                      "type": {
                        "type": "string",
                        "enum": [
                          "value"
                        ]
                      },
                      "value": {
                        "type": "string",
                        "minLength": 1
                      }
                    },
                    "additionalProperties": false,
                    "required": [
                      "name",
                      "type",
                      "value"
                    ]
                  },
                  {
                    "properties": {
                      "name": {
                        "$ref": "#/definitions/eVarName"
                      },
                      "type": {
                        "type": "string",
                        "enum": [
                          "alias"
                        ]
                      },
                      "value": {
                        "type": "string",
                        "oneOf": [
                          {
                            "$ref": "#/definitions/eVarName"
                          },
                          {
                            "$ref": "#/definitions/propName"
                          }
                        ]
                      }
                    },
                    "additionalProperties": false,
                    "required": [
                      "name",
                      "type",
                      "value"
                    ]
                  }
                ]
              }
            },
            "props": {
              "type": "array",
              "items": {
                "type": "object",
                "oneOf": [
                  {
                    "properties": {
                      "name": {
                        "$ref": "#/definitions/propName"
                      },
                      "type": {
                        "type": "string",
                        "enum": [
                          "value"
                        ]
                      },
                      "value": {
                        "type": "string",
                        "minLength": 1
                      }
                    },
                    "additionalProperties": false,
                    "required": [
                      "name",
                      "type",
                      "value"
                    ]
                  },
                  {
                    "properties": {
                      "name": {
                        "$ref": "#/definitions/propName"
                      },
                      "type": {
                        "type": "string",
                        "enum": [
                          "alias"
                        ]
                      },
                      "value": {
                        "type": "string",
                        "oneOf": [
                          {
                            "$ref": "#/definitions/eVarName"
                          },
                          {
                            "$ref": "#/definitions/propName"
                          }
                        ]
                      }
                    },
                    "additionalProperties": false,
                    "required": [
                      "name",
                      "type",
                      "value"
                    ]
                  }
                ]
              }
            }
          },
          "additionalProperties": false
        },
        "customSetup": {
          "type": "object",
          "properties": {
            "loadPhase": {
              "type": "string",
              "enum": [
                "beforeSettings",
                "afterSettings"
              ]
            },
            "script": {
              "type": "string",
              "minLength": 1
            }
          },
          "additionalProperties": false,
          "required": [
            "loadPhase",
            "script"
          ]
        }
      },
      "additionalProperties": false,
      "required": [
        "libraryCode"
      ],
      "definitions": {
        "loadPhase": {
          "type": "string",
          "enum": [
            "pageTop",
            "pageBottom"
          ]
        },
        "trackerVariableName": {
          "type": "string",
          "minLength": 1
        },
        "eVarName": {
          "type": "string",
          "pattern": "^eVar(\\d+)$"
        },
        "propName": {
          "type": "string",
          "pattern": "^prop(\\d+)$"
        },
        "accounts": {
          "properties": {
            "production": {
              "$ref": "#/definitions/accountsList"
            },
            "staging": {
              "$ref": "#/definitions/accountsList"
            },
            "development": {
              "$ref": "#/definitions/accountsList"
            }
          },
          "additionalProperties": false,
          "required": [
            "production"
          ]
        },
        "accountsList": {
          "minItems": 1,
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          }
        }
      }
    },
    "transform": {
      "libraryCode.script": {
        "type": "file",
        "extension": "js"
      },
      "customSetup.script": {
        "type": "function"
      }
    }
  },
  "actions": [
    {
      "name": "set-variables",
      "displayName": "Set Variables",
      "libPath": "actions/setVariables.js",
      "viewPath": "index.html#/actions/setVariables",
      "schema": {
        "$schema": "http://json-schema.org/draft-04/schema#",
        "type": "object",
        "properties": {
          "extensionConfigurationIds": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            },
            "minItems": 1
          },
          "trackerProperties": {
            "properties": {
              "server": {
                "type": "string",
                "minLength": 1
              },
              "pageName": {
                "type": "string",
                "minLength": 1
              },
              "pageURL": {
                "type": "string",
                "minLength": 1
              },
              "channel": {
                "type": "string",
                "minLength": 1
              },
              "referrer": {
                "type": "string",
                "minLength": 1
              },
              "campaign": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "value",
                      "queryParam"
                    ]
                  },
                  "value": {
                    "type": "string",
                    "minLength": 1
                  }
                },
                "additionalProperties": false,
                "required": [
                  "type",
                  "value"
                ]
              },
              "visitorID": {
                "type": "string",
                "minLength": 1
              },
              "transactionID": {
                "type": "string",
                "minLength": 1
              },

              "hierarchies": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string",
                      "pattern": "^hier[1-5]$"
                    },
                    "sections": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "minLength": 1
                      },
                      "minItems": 1,
                      "maxItems": 4
                    },
                    "delimiter": {
                      "type": "string",
                      "minLength": 1
                    }
                  },
                  "additionalProperties": false,
                  "required": [
                    "name",
                    "sections",
                    "delimiter"
                  ]
                }
              },
              "eVars": {
                "type": "array",
                "items": {
                  "type": "object",
                  "oneOf": [
                    {
                      "properties": {
                        "name": {
                          "$ref": "#/definitions/eVarName"
                        },
                        "type": {
                          "type": "string",
                          "enum": [
                            "value"
                          ]
                        },
                        "value": {
                          "type": "string",
                          "minLength": 1
                        }
                      },
                      "additionalProperties": false,
                      "required": [
                        "name",
                        "type",
                        "value"
                      ]
                    },
                    {
                      "properties": {
                        "name": {
                          "$ref": "#/definitions/eVarName"
                        },
                        "type": {
                          "type": "string",
                          "enum": [
                            "alias"
                          ]
                        },
                        "value": {
                          "type": "string",
                          "oneOf": [
                            {
                              "$ref": "#/definitions/eVarName"
                            },
                            {
                              "$ref": "#/definitions/propName"
                            }
                          ]
                        }
                      },
                      "additionalProperties": false,
                      "required": [
                        "name",
                        "type",
                        "value"
                      ]
                    }
                  ]
                }
              },
              "props": {
                "type": "array",
                "items": {
                  "type": "object",
                  "oneOf": [
                    {
                      "properties": {
                        "name": {
                          "$ref": "#/definitions/propName"
                        },
                        "type": {
                          "type": "string",
                          "enum": [
                            "value"
                          ]
                        },
                        "value": {
                          "type": "string",
                          "minLength": 1
                        }
                      },
                      "additionalProperties": false,
                      "required": [
                        "name",
                        "type",
                        "value"
                      ]
                    },
                    {
                      "properties": {
                        "name": {
                          "$ref": "#/definitions/propName"
                        },
                        "type": {
                          "type": "string",
                          "enum": [
                            "alias"
                          ]
                        },
                        "value": {
                          "type": "string",
                          "oneOf": [
                            {
                              "$ref": "#/definitions/eVarName"
                            },
                            {
                              "$ref": "#/definitions/propName"
                            }
                          ]
                        }
                      },
                      "additionalProperties": false,
                      "required": [
                        "name",
                        "type",
                        "value"
                      ]
                    }
                  ]
                }
              },
              "events": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string",
                      "minLength": 1
                    },
                    "value": {
                      "type": "string",
                      "minLength": 1
                    }
                  },
                  "additionalProperties": false,
                  "required": [
                    "name"
                  ]
                }
              }
            },
            "additionalProperties": false
          },
          "customSetup": {
            "type": "object",
            "properties": {
              "script": {
                "type": "string",
                "minLength": 1
              }
            },
            "additionalProperties": false,
            "required": [
              "script"
            ]
          }
        },
        "additionalProperties": false,
        "definitions": {
          "eVarName": {
            "type": "string",
            "pattern": "^eVar(\\d+)$"
          },
          "propName": {
            "type": "string",
            "pattern": "^prop(\\d+)$"
          }
        }
      }
    },
    {
      "name": "send-beacon",
      "displayName": "Send Beacon",
      "libPath": "actions/sendBeacon.js",
      "viewPath": "index.html#/actions/sendBeacon",
      "schema": {
        "$schema": "http://json-schema.org/draft-04/schema#",
        "type": "object",
        "oneOf": [
          {
            "properties": {
              "extensionConfigurationIds": {
                "$ref": "#/definitions/extensionConfigurationIds"
              },
              "type": {
                "type": "string",
                "enum": [
                  "page"
                ]
              }
            },
            "required": [
              "type"
            ],
            "additionalProperties": false
          },
          {
            "properties": {
              "extensionConfigurationIds": {
                "$ref": "#/definitions/extensionConfigurationIds"
              },
              "type": {
                "type": "string",
                "enum": [
                  "link"
                ]
              },
              "linkType": {
                "type": "string",
                "enum": [
                  "o",
                  "d",
                  "e"
                ]
              },
              "linkName": {
                "type": "string"
              }
            },
            "required": [
              "type",
              "linkType"
            ],
            "additionalProperties": false
          }
        ],
        "definitions": {
          "extensionConfigurationIds": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            },
            "minItems": 1
          }
        }
      }
    }
  ],
  "helpers": [
    {
      "name": "get-tracker",
      "libPath": "helpers/getTracker.js"
    },
    {
      "name": "apply-tracker-variables",
      "libPath": "helpers/applyTrackerVariables.js"
    },
    {
      "name": "load-library",
      "libPath": "helpers/loadLibrary.js"
    }
  ]
}
